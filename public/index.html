<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>BSC Store ‚Äî Society Delivery</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
<style>
:root {
  --yellow: #f8c200; --yellow-dark: #e6b400;
  --dark: #1a1a1a; --dark2: #222831;
  --green: #00b96b; --green-light: #e6faf2;
  --red: #f03e3e; --orange: #ff6b35;
  --blue: #3b82f6;
  --border: #eef2f7; --text: #1e293b;
  --subtext: #64748b; --light: #f8fafc;
  --white: #fff;
  --card-shadow: 0 2px 16px rgba(0,0,0,0.07);
  --radius: 16px;
}
* { margin:0; padding:0; box-sizing:border-box; }
body { font-family:'Poppins',sans-serif; background:#f4f7fb; color:var(--text); overflow-x:hidden; }
button { font-family:'Poppins',sans-serif; cursor:pointer; border:none; }

/* ‚îÄ‚îÄ HEADER ‚îÄ‚îÄ */
.header { background:var(--dark); position:sticky; top:0; z-index:200; padding:0 1rem; box-shadow:0 4px 20px rgba(0,0,0,.3); }
.header-top { display:flex; align-items:center; gap:.75rem; height:58px; max-width:1100px; margin:0 auto; }
.logo { display:flex; align-items:center; gap:.45rem; flex-shrink:0; text-decoration:none; }
.logo-icon { background:var(--yellow); border-radius:10px; width:34px; height:34px; display:flex; align-items:center; justify-content:center; font-size:1.15rem; }
.logo-text { color:white; font-weight:900; font-size:1.05rem; letter-spacing:-.5px; }
.logo-text span { color:var(--yellow); }
.search-bar { flex:1; display:flex; align-items:center; gap:.5rem; background:#2a2a2a; border-radius:11px; padding:.42rem .85rem; border:1.5px solid transparent; transition:border-color .2s; }
.search-bar:focus-within { border-color:var(--yellow); }
.search-bar input { background:none; border:none; outline:none; color:white; font-family:'Poppins',sans-serif; font-size:.85rem; width:100%; }
.search-bar input::placeholder { color:#555; }
.hdr-btns { display:flex; gap:.45rem; align-items:center; flex-shrink:0; }
.cart-btn { background:var(--yellow); border-radius:11px; padding:.42rem .9rem; display:flex; align-items:center; gap:.4rem; font-weight:800; font-size:.82rem; color:var(--dark); transition:transform .15s,background .15s; position:relative; }
.cart-btn:hover { transform:scale(1.04); background:var(--yellow-dark); }
.cart-btn .cnt { background:var(--dark); color:var(--yellow); border-radius:6px; width:20px; height:20px; display:flex; align-items:center; justify-content:center; font-size:.68rem; font-weight:800; }
.acct-btn { background:#2a2a2a; border-radius:11px; padding:.42rem .7rem; color:white; font-size:1rem; transition:background .2s; }
.acct-btn:hover { background:#3a3a3a; }

/* ‚îÄ‚îÄ MAIN ‚îÄ‚îÄ */
.main { max-width:1100px; margin:0 auto; padding:0 1rem 7rem; }

/* ‚îÄ‚îÄ BANNER ‚îÄ‚îÄ */
.banner-wrap { margin:1rem 0; border-radius:var(--radius); overflow:hidden; position:relative; cursor:pointer; }
.banner-slider { display:flex; transition:transform .5s cubic-bezier(.4,0,.2,1); }
.banner-slide { min-width:100%; height:155px; display:flex; align-items:center; justify-content:space-between; padding:1.4rem 2rem; overflow:hidden; }
.b1{background:linear-gradient(135deg,#0f3460,#16213e);} .b2{background:linear-gradient(135deg,#1b4332,#2d6a4f);} .b3{background:linear-gradient(135deg,#7c2d12,#c2410c);} .b4{background:linear-gradient(135deg,#4c1d95,#6d28d9);}
.banner-tag { background:var(--yellow); color:var(--dark); font-size:.58rem; font-weight:800; padding:.18rem .55rem; border-radius:50px; text-transform:uppercase; display:inline-block; margin-bottom:.45rem; }
.banner-title { color:white; font-size:1.45rem; font-weight:900; line-height:1.15; }
.banner-sub { color:rgba(255,255,255,.6); font-size:.75rem; margin-top:.3rem; }
.banner-emoji { font-size:5rem; filter:drop-shadow(0 4px 12px rgba(0,0,0,.3)); }
.banner-dots { position:absolute; bottom:.7rem; left:50%; transform:translateX(-50%); display:flex; gap:.35rem; z-index:2; }
.dot { width:5px; height:5px; border-radius:50%; background:rgba(255,255,255,.3); transition:all .3s; cursor:pointer; }
.dot.active { background:var(--yellow); width:18px; border-radius:3px; }

/* ‚îÄ‚îÄ SECTIONS ‚îÄ‚îÄ */
.sec-head { font-weight:800; font-size:1rem; margin:1.4rem 0 .7rem; color:var(--dark); display:flex; align-items:center; gap:.4rem; }
.cats-scroll { display:flex; gap:.65rem; overflow-x:auto; padding-bottom:.4rem; scrollbar-width:none; }
.cats-scroll::-webkit-scrollbar { display:none; }
.cat-chip { display:flex; flex-direction:column; align-items:center; gap:.35rem; flex-shrink:0; cursor:pointer; background:white; border-radius:13px; padding:.7rem .45rem; width:78px; box-shadow:var(--card-shadow); border:2px solid transparent; transition:all .2s; }
.cat-chip:hover { border-color:var(--yellow); transform:translateY(-2px); }
.cat-chip.active { border-color:var(--yellow); background:#fffbeb; }
.cat-chip img { width:44px; height:44px; object-fit:cover; border-radius:9px; }
.cat-chip span.name { font-size:.6rem; font-weight:600; text-align:center; color:var(--text); line-height:1.2; }

/* ‚îÄ‚îÄ FILTER BAR ‚îÄ‚îÄ */
.filter-bar { display:flex; gap:.45rem; margin:.5rem 0 .9rem; overflow-x:auto; scrollbar-width:none; }
.filter-bar::-webkit-scrollbar { display:none; }
.fc { background:white; border:1.5px solid var(--border); border-radius:20px; padding:.28rem .75rem; font-size:.72rem; font-weight:600; color:var(--subtext); cursor:pointer; white-space:nowrap; transition:all .2s; flex-shrink:0; }
.fc:hover, .fc.active { border-color:var(--yellow); background:#fffbeb; color:var(--dark); }

/* ‚îÄ‚îÄ PRODUCTS GRID ‚îÄ‚îÄ */
.products-grid { display:grid; grid-template-columns:repeat(auto-fill,minmax(170px,1fr)); gap:.9rem; }

/* ‚îÄ‚îÄ PRODUCT CARD ‚îÄ‚îÄ */
.product-card { background:white; border-radius:var(--radius); overflow:hidden; box-shadow:var(--card-shadow); transition:transform .2s,box-shadow .2s; border:1.5px solid transparent; position:relative; }
.product-card:hover { transform:translateY(-3px); box-shadow:0 10px 28px rgba(0,0,0,.11); }
.product-card.featured { border-color:#fbbf24; }
.badge-feat { position:absolute; top:.45rem; left:.45rem; background:var(--yellow); color:var(--dark); font-size:.55rem; font-weight:800; padding:.13rem .42rem; border-radius:5px; z-index:2; text-transform:uppercase; letter-spacing:.04em; }
.badge-bulk { position:absolute; top:.45rem; right:.45rem; background:var(--green); color:white; font-size:.55rem; font-weight:800; padding:.13rem .42rem; border-radius:5px; z-index:2; white-space:nowrap; }
.product-img-wrap { background:#f4f7fb; height:138px; display:flex; align-items:center; justify-content:center; padding:.7rem; position:relative; overflow:hidden; }
.product-img-wrap img { width:100%; height:100%; object-fit:contain; transition:transform .3s; }
.product-card:hover .product-img-wrap img { transform:scale(1.06); }
.fallback-e { font-size:3.2rem; }
.out-overlay { position:absolute; inset:0; background:rgba(255,255,255,.9); display:flex; align-items:center; justify-content:center; font-size:.75rem; font-weight:700; color:var(--red); }
.stock-low { position:absolute; bottom:.3rem; right:.3rem; font-size:.56rem; font-weight:700; background:#ff6b35; color:white; padding:.1rem .38rem; border-radius:5px; }
.product-body { padding:.75rem .7rem .7rem; }
.product-name { font-weight:700; font-size:.8rem; line-height:1.3; margin-bottom:.12rem; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
.product-unit { font-size:.67rem; color:var(--subtext); margin-bottom:.42rem; }

/* Bulk pricing hint on card */
.bulk-hint { font-size:.6rem; color:var(--green); font-weight:600; margin-bottom:.4rem; background:var(--green-light); padding:.15rem .4rem; border-radius:5px; display:inline-block; }

.price-row { display:flex; align-items:center; justify-content:space-between; }
.price-block { display:flex; flex-direction:column; }
.price-main { font-weight:800; font-size:.92rem; color:var(--dark); }
.price-main.bulk { color:var(--green); }
.price-orig { font-size:.68rem; color:var(--subtext); text-decoration:line-through; }
.add-btn { background:white; border:2px solid var(--green); color:var(--green); border-radius:9px; padding:.28rem .8rem; font-weight:700; font-size:.76rem; transition:all .15s; }
.add-btn:hover { background:var(--green); color:white; }
.add-btn:disabled { border-color:#ddd; color:#ddd; cursor:not-allowed; }
.qty-box { display:flex; align-items:center; background:var(--green); border-radius:9px; overflow:hidden; }
.qty-box button { background:none; color:white; font-size:.95rem; font-weight:800; padding:.26rem .55rem; }
.qty-box .qnum { color:white; font-weight:800; font-size:.8rem; min-width:19px; text-align:center; }

/* ‚îÄ‚îÄ OVERLAY ‚îÄ‚îÄ */
.overlay { display:none; position:fixed; inset:0; background:rgba(0,0,0,.55); z-index:300; backdrop-filter:blur(4px); }
.overlay.open { display:block; }

/* ‚îÄ‚îÄ CART SIDEBAR ‚Äî PREMIUM ‚îÄ‚îÄ */
.cart-sidebar { position:fixed; right:-110%; top:0; width:min(430px,100%); height:100%; background:var(--dark2); z-index:400; display:flex; flex-direction:column; transition:right .35s cubic-bezier(.4,0,.2,1); box-shadow:-10px 0 50px rgba(0,0,0,.3); }
.cart-sidebar.open { right:0; }

/* Cart header */
.cart-hdr { background:#1a1f2e; padding:1rem 1.4rem; display:flex; align-items:center; justify-content:space-between; border-bottom:1px solid rgba(255,255,255,.06); flex-shrink:0; }
.cart-hdr-left h2 { color:white; font-weight:800; font-size:1rem; }
.cart-hdr-left .cart-meta { color:rgba(255,255,255,.4); font-size:.72rem; margin-top:.1rem; }
.cart-close { background:rgba(255,255,255,.08); color:rgba(255,255,255,.6); border-radius:8px; width:30px; height:30px; display:flex; align-items:center; justify-content:center; font-size:1rem; transition:all .15s; }
.cart-close:hover { background:rgba(255,255,255,.15); color:white; }

/* Savings hero banner inside cart */
.cart-savings-hero { background:linear-gradient(135deg,#064e3b,#065f46); padding:.85rem 1.4rem; display:flex; align-items:center; gap:.75rem; flex-shrink:0; }
.savings-icon { font-size:1.8rem; }
.savings-text { flex:1; }
.savings-text .savings-label { color:rgba(255,255,255,.6); font-size:.68rem; font-weight:600; }
.savings-text .savings-amt { color:#34d399; font-size:1.25rem; font-weight:900; line-height:1; }
.savings-text .savings-sub { color:rgba(255,255,255,.4); font-size:.62rem; }
.savings-badge { background:rgba(52,211,153,.15); border:1px solid rgba(52,211,153,.3); border-radius:10px; padding:.4rem .7rem; text-align:center; }
.savings-badge .sb-label { color:rgba(255,255,255,.5); font-size:.6rem; }
.savings-badge .sb-val { color:#34d399; font-weight:800; font-size:.9rem; }

/* Delivery info strip */
.delivery-strip { background:#1a1f2e; padding:.55rem 1.4rem; display:flex; align-items:center; gap:.5rem; flex-shrink:0; border-bottom:1px solid rgba(255,255,255,.05); }
.delivery-strip p { color:rgba(255,255,255,.5); font-size:.72rem; }
.delivery-strip .free-tag { background:var(--green); color:white; font-size:.6rem; font-weight:800; padding:.1rem .35rem; border-radius:4px; margin-left:.3rem; }

/* Min order progress */
.min-order-bar { padding:.7rem 1.4rem; flex-shrink:0; }
.mob-row { display:flex; align-items:center; justify-content:space-between; margin-bottom:.3rem; }
.mob-label { color:rgba(255,255,255,.5); font-size:.68rem; }
.mob-amt { color:white; font-weight:700; font-size:.75rem; }
.mob-progress { background:rgba(255,255,255,.1); border-radius:6px; height:6px; overflow:hidden; }
.mob-fill { height:100%; background:linear-gradient(90deg,var(--yellow),#f97316); border-radius:6px; transition:width .4s ease; }

/* Cart items */
.cart-items { flex:1; overflow-y:auto; padding:.6rem 1.4rem; scrollbar-width:thin; scrollbar-color:rgba(255,255,255,.1) transparent; }
.cart-empty { text-align:center; padding:3.5rem 1rem; }
.cart-empty .ei { font-size:3.5rem; }
.cart-empty p { color:rgba(255,255,255,.4); font-size:.85rem; margin-top:.6rem; line-height:1.6; }

/* Individual cart item */
.cart-item { display:flex; gap:.7rem; padding:.8rem 0; border-bottom:1px solid rgba(255,255,255,.05); position:relative; }
.ci-img { width:58px; height:58px; object-fit:contain; background:rgba(255,255,255,.06); border-radius:11px; padding:4px; flex-shrink:0; }
.ci-emoji { width:58px; height:58px; background:rgba(255,255,255,.06); border-radius:11px; display:flex; align-items:center; justify-content:center; font-size:1.8rem; flex-shrink:0; }
.ci-body { flex:1; min-width:0; }
.ci-name { color:white; font-weight:700; font-size:.8rem; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
.ci-price-line { display:flex; align-items:center; gap:.4rem; margin-top:.15rem; }
.ci-unit-price { color:rgba(255,255,255,.45); font-size:.7rem; }
.ci-bulk-tag { background:rgba(52,211,153,.18); color:#34d399; font-size:.6rem; font-weight:700; padding:.1rem .35rem; border-radius:4px; }
.ci-saving { background:rgba(251,191,36,.12); color:#fbbf24; font-size:.6rem; font-weight:700; padding:.1rem .35rem; border-radius:4px; }
.ci-subtotal { color:#34d399; font-weight:800; font-size:.82rem; margin-top:.25rem; }
.ci-subtotal .ci-original { color:rgba(255,255,255,.3); font-size:.7rem; text-decoration:line-through; margin-left:.3rem; }
.ci-controls { display:flex; align-items:center; background:rgba(255,255,255,.08); border-radius:9px; overflow:hidden; flex-shrink:0; align-self:center; }
.ci-controls button { background:none; color:white; font-size:.9rem; font-weight:800; padding:.28rem .55rem; transition:background .15s; }
.ci-controls button:hover { background:rgba(255,255,255,.1); }
.ci-controls .cnum { color:white; font-weight:800; font-size:.8rem; min-width:18px; text-align:center; }

/* Bulk tier hint inside cart item */
.ci-next-tier { color:rgba(251,191,36,.7); font-size:.6rem; margin-top:.2rem; }

/* Per-item tier ladder in cart */
.ci-tier-ladder { display:flex; align-items:center; gap:.3rem; margin-top:.45rem; flex-wrap:wrap; }
.ci-tier-pip { display:flex; flex-direction:column; align-items:center; gap:.1rem; }
.ci-tier-dot { width:22px; height:22px; border-radius:6px; background:rgba(255,255,255,.07); border:1.5px solid rgba(255,255,255,.12); display:flex; align-items:center; justify-content:center; font-size:.58rem; font-weight:800; color:rgba(255,255,255,.35); transition:all .3s; position:relative; }
.ci-tier-dot.active { background:rgba(52,211,153,.2); border-color:#34d399; color:#34d399; }
.ci-tier-dot.next { border-color:rgba(251,191,36,.5); color:rgba(251,191,36,.7); animation:pulse-tier 1.5s infinite; }
.ci-tier-label { font-size:.55rem; color:rgba(255,255,255,.3); white-space:nowrap; }
.ci-tier-label.active { color:#34d399; }
.ci-tier-label.next { color:rgba(251,191,36,.7); }
.ci-tier-arrow { color:rgba(255,255,255,.15); font-size:.65rem; margin-bottom:10px; }
@keyframes pulse-tier { 0%,100%{box-shadow:0 0 0 0 rgba(251,191,36,.35)} 50%{box-shadow:0 0 0 4px rgba(251,191,36,0)} }
.ci-saving-big { background:linear-gradient(135deg,rgba(52,211,153,.15),rgba(16,185,129,.1)); border:1px solid rgba(52,211,153,.25); border-radius:8px; padding:.3rem .6rem; display:inline-flex; align-items:center; gap:.3rem; margin-top:.35rem; }
.ci-saving-big span { color:#34d399; font-weight:800; font-size:.78rem; }
.ci-saving-big .sl { color:rgba(255,255,255,.4); font-size:.65rem; }
.ci-unlock-bar { margin-top:.4rem; }
.ci-unlock-row { display:flex; justify-content:space-between; align-items:center; margin-bottom:.2rem; }
.ci-unlock-label { color:rgba(251,191,36,.8); font-size:.6rem; font-weight:600; }
.ci-unlock-progress { background:rgba(255,255,255,.06); border-radius:4px; height:4px; overflow:hidden; }
.ci-unlock-fill { height:100%; background:linear-gradient(90deg,#fbbf24,#f59e0b); border-radius:4px; transition:width .4s ease; }

/* ‚îÄ‚îÄ CART FOOTER ‚îÄ‚îÄ */
.cart-footer { padding:.85rem 1.4rem 1rem; border-top:1px solid rgba(255,255,255,.07); flex-shrink:0; }
.bill-section { background:rgba(255,255,255,.04); border-radius:13px; padding:.85rem 1rem; margin-bottom:.85rem; }
.bill-row { display:flex; justify-content:space-between; align-items:center; padding:.2rem 0; }
.bill-row .bl { color:rgba(255,255,255,.5); font-size:.8rem; }
.bill-row .br { color:rgba(255,255,255,.8); font-size:.8rem; font-weight:600; }
.bill-row.savings-row .bl { color:#34d399; font-size:.78rem; }
.bill-row.savings-row .br { color:#34d399; font-weight:700; }
.bill-divider { border:none; border-top:1px dashed rgba(255,255,255,.1); margin:.4rem 0; }
.bill-total-row { display:flex; justify-content:space-between; align-items:center; padding:.2rem 0; }
.bill-total-row .tl { color:white; font-weight:700; font-size:.9rem; }
.bill-total-row .tr { color:var(--yellow); font-weight:900; font-size:1.1rem; }
.checkout-btn { width:100%; background:var(--yellow); border-radius:13px; padding:.88rem 1.2rem; font-weight:800; font-size:.95rem; color:var(--dark); display:flex; align-items:center; justify-content:space-between; transition:all .15s; }
.checkout-btn:hover { background:var(--yellow-dark); transform:scale(1.01); }
.checkout-btn:disabled { background:#3a3a3a; color:#666; cursor:not-allowed; transform:none; }
.checkout-btn .cbamt { background:rgba(0,0,0,.2); color:var(--dark); border-radius:8px; padding:.18rem .55rem; font-size:.8rem; }

/* ‚îÄ‚îÄ FLOATING CART ‚îÄ‚îÄ */
.floating-cart { position:fixed; bottom:1.4rem; left:50%; transform:translateX(-50%); background:var(--dark); border-radius:16px; padding:.8rem 1.4rem; display:none; align-items:center; justify-content:space-between; gap:2rem; z-index:100; min-width:290px; box-shadow:0 8px 32px rgba(0,0,0,.35); animation:fadeUp .3s ease; cursor:pointer; border:none; }
.floating-cart.show { display:flex; }
@keyframes fadeUp { from{opacity:0;transform:translateX(-50%) translateY(20px)} to{opacity:1;transform:translateX(-50%) translateY(0)} }
.fc-left { display:flex; align-items:center; gap:.55rem; }
.fc-cnt { background:var(--yellow); color:var(--dark); border-radius:7px; width:26px; height:26px; display:flex; align-items:center; justify-content:center; font-weight:800; font-size:.78rem; }
.fc-info { }
.fc-info .fc-items { color:rgba(255,255,255,.7); font-size:.75rem; }
.fc-info .fc-saving { color:#34d399; font-size:.65rem; font-weight:700; }
.fc-right { color:var(--yellow); font-weight:800; font-size:.85rem; }

/* ‚îÄ‚îÄ ORDER MODAL ‚îÄ‚îÄ */
.modal-overlay { display:none; position:fixed; inset:0; background:rgba(0,0,0,.65); z-index:500; align-items:flex-end; justify-content:center; backdrop-filter:blur(5px); }
.modal-overlay.open { display:flex; }
.modal { background:white; border-radius:22px 22px 0 0; width:min(500px,100%); max-height:92vh; overflow-y:auto; animation:slideUp .3s ease; }
@keyframes slideUp { from{transform:translateY(100%)} to{transform:translateY(0)} }
.modal-handle { width:38px; height:4px; background:#ddd; border-radius:2px; margin:.9rem auto .4rem; }
.modal-head { padding:.4rem 1.4rem .9rem; border-bottom:1px solid var(--border); }
.modal-head h2 { font-weight:800; font-size:1rem; }
.modal-body { padding:1.4rem; }
.fg { margin-bottom:.85rem; }
.fg label { display:block; font-weight:600; font-size:.72rem; color:var(--subtext); margin-bottom:.38rem; text-transform:uppercase; letter-spacing:.05em; }
.fg input,.fg select { width:100%; border:2px solid var(--border); border-radius:11px; padding:.62rem .9rem; font-family:'Poppins',sans-serif; font-size:.86rem; color:var(--text); transition:border-color .2s; background:var(--light); }
.fg input:focus,.fg select:focus { outline:none; border-color:var(--yellow); background:white; }
.fg select { appearance:none; background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='8'%3E%3Cpath d='M1 1l5 5 5-5' stroke='%2364748b' stroke-width='2' fill='none' stroke-linecap='round'/%3E%3C/svg%3E"); background-repeat:no-repeat; background-position:right .9rem center; padding-right:2.4rem; }
.addr-row { display:grid; grid-template-columns:1fr 1fr; gap:.75rem; }
.block-hint { background:#f0fdf4; border:1.5px solid #bbf7d0; border-radius:10px; padding:.55rem .9rem; font-size:.73rem; color:var(--green); font-weight:600; margin-bottom:.85rem; }
.qr-card { background:linear-gradient(135deg,#1a1a2e,#0f3460); border-radius:15px; padding:1.4rem; text-align:center; margin:.9rem 0; }
.qr-card h3 { color:white; font-weight:700; font-size:.92rem; margin-bottom:.2rem; }
.qr-sub { color:rgba(255,255,255,.5); font-size:.72rem; margin-bottom:.9rem; }
.qr-img-box { background:white; border-radius:11px; width:145px; height:145px; margin:0 auto; display:flex; align-items:center; justify-content:center; font-size:.72rem; color:#aaa; text-align:center; overflow:hidden; }
.qr-img-box img { width:100%; height:100%; object-fit:contain; }
.pay-amt { color:var(--yellow); font-size:1.5rem; font-weight:900; margin-top:.7rem; }
.pay-note { color:rgba(255,255,255,.4); font-size:.68rem; margin-top:.2rem; }
.order-summary { background:#f0fdf4; border-radius:11px; padding:.85rem .95rem; margin-bottom:.9rem; border:1.5px solid #bbf7d0; }
.os-row { display:flex; justify-content:space-between; font-size:.8rem; padding:.18rem 0; }
.os-row.saving { color:var(--green); font-weight:600; }
.os-row.total { font-weight:800; font-size:.92rem; border-top:1px dashed #ddd; padding-top:.45rem; margin-top:.3rem; }
.place-btn { width:100%; background:var(--yellow); border-radius:13px; padding:.92rem; font-weight:800; font-size:.92rem; color:var(--dark); margin-top:.4rem; transition:all .15s; }
.place-btn:hover { background:var(--yellow-dark); }
.success-screen { display:none; text-align:center; padding:2.5rem 1.4rem; }
.success-screen.show { display:block; }
.success-anim { font-size:5rem; animation:pop .5s ease; display:block; }
@keyframes pop { 0%{transform:scale(0)} 70%{transform:scale(1.2)} 100%{transform:scale(1)} }
.success-screen h2 { font-weight:900; font-size:1.25rem; margin:.65rem 0 .3rem; }
.success-screen p { color:var(--subtext); font-size:.85rem; line-height:1.6; }
.continue-btn { background:var(--yellow); border-radius:12px; padding:.75rem 2rem; font-weight:800; font-size:.92rem; color:var(--dark); margin-top:1.4rem; }

/* ‚îÄ‚îÄ ACCOUNT MODAL ‚îÄ‚îÄ */
.acct-modal { display:none; position:fixed; inset:0; background:rgba(0,0,0,.6); z-index:600; align-items:center; justify-content:center; backdrop-filter:blur(4px); }
.acct-modal.open { display:flex; }
.acct-box { background:white; border-radius:20px; width:min(390px,94vw); overflow:hidden; }
.acct-box-hd { background:var(--dark); padding:1.15rem 1.4rem; display:flex; align-items:center; justify-content:space-between; }
.acct-box-hd h3 { color:white; font-weight:800; font-size:.95rem; }
.acct-close { background:none; color:#888; font-size:1.2rem; }
.acct-tabs { display:flex; border-bottom:2px solid var(--border); }
.atab { flex:1; padding:.7rem; font-weight:700; font-size:.82rem; color:var(--subtext); border-bottom:2px solid transparent; margin-bottom:-2px; transition:all .2s; }
.atab.active { color:var(--yellow); border-bottom-color:var(--yellow); }
.acct-body { padding:1.4rem; }
.auth-form .fg { margin-bottom:.7rem; }
.auth-submit { width:100%; background:var(--yellow); border-radius:11px; padding:.75rem; font-weight:800; font-size:.88rem; color:var(--dark); margin-top:.4rem; }
.auth-msg { font-size:.76rem; text-align:center; margin-top:.4rem; }
.auth-msg.err { color:var(--red); }
.auth-msg.ok { color:var(--green); }
.logged-view { text-align:center; }
.user-avatar { font-size:3rem; }
.logged-view h3 { font-weight:800; margin:.45rem 0 .2rem; }
.logged-view p { color:var(--subtext); font-size:.82rem; }
.oh-list { margin-top:.9rem; text-align:left; }
.oh-list h4 { font-weight:700; font-size:.82rem; margin-bottom:.55rem; }
.oh-item { background:var(--light); border-radius:9px; padding:.6rem .85rem; margin-bottom:.4rem; display:flex; justify-content:space-between; align-items:center; }
.oh-date { font-size:.7rem; color:var(--subtext); }
.oh-status { font-size:.68rem; font-weight:600; padding:.12rem .4rem; border-radius:5px; }
.oh-status.new { background:#e0f2fe; color:#0369a1; }
.oh-status.delivered { background:var(--green-light); color:var(--green); }
.logout-btn { background:#fee2e2; color:var(--red); border-radius:9px; padding:.62rem 1.4rem; font-weight:700; font-size:.82rem; margin-top:.9rem; width:100%; }

/* ‚îÄ‚îÄ BULK PRICING TOOLTIP on product card ‚îÄ‚îÄ */
.bulk-tiers-preview { display:flex; gap:.3rem; margin-bottom:.4rem; flex-wrap:wrap; }
.btp { background:#e8f5ee; color:var(--green); font-size:.58rem; font-weight:700; padding:.1rem .38rem; border-radius:4px; white-space:nowrap; }
.btp.active { background:var(--green); color:white; }

@media(max-width:600px) {
  .banner-slide { height:125px; padding:.9rem 1.1rem; }
  .banner-title { font-size:1.15rem; }
  .banner-emoji { font-size:3.5rem; }
  .products-grid { grid-template-columns:repeat(2,1fr); gap:.65rem; }
  .product-img-wrap { height:115px; }
  .addr-row { grid-template-columns:1fr; gap:.5rem; }
}
</style>
</head>
<body>

<div class="header">
  <div class="header-top">
    <a class="logo" href="/">
      <div class="logo-icon">üõí</div>
      <div class="logo-text">BSC <span>Store</span></div>
    </a>
    <div class="search-bar">
      <span>üîç</span>
      <input type="text" id="searchInput" placeholder='Search "milk, chips, rice..."' oninput="doSearch(this.value)">
    </div>
    <div class="hdr-btns">
      <button class="acct-btn" onclick="openAcct()" title="Account">üë§</button>
      <button class="cart-btn" onclick="openCart()">üõí <span class="cnt" id="cartCount">0</span></button>
    </div>
  </div>
</div>

<div class="main">
  <!-- BANNER -->
  <div class="banner-wrap">
    <div class="banner-slider" id="bannerSlider">
      <div class="banner-slide b1"><div><div class="banner-tag">üèòÔ∏è Society Delivery</div><div class="banner-title">Fresh Groceries<br>At Your Door</div><div class="banner-sub">Delivered within BSC Society!</div></div><div class="banner-emoji">üõí</div></div>
      <div class="banner-slide b2"><div><div class="banner-tag">üí∞ Buy More, Save More</div><div class="banner-title">Bulk Discounts<br>On Every Product!</div><div class="banner-sub">Price drops as you add more</div></div><div class="banner-emoji">üéÅ</div></div>
      <div class="banner-slide b3"><div><div class="banner-tag">ü•õ Dairy Fresh</div><div class="banner-title">Fresh Milk &<br>Dairy Daily</div><div class="banner-sub">Morning fresh, every day</div></div><div class="banner-emoji">ü•õ</div></div>
      <div class="banner-slide b4"><div><div class="banner-tag">üçø Snack Time</div><div class="banner-title">Stock Up &<br>Save Big!</div><div class="banner-sub">Bulk prices on snacks & drinks</div></div><div class="banner-emoji">üçü</div></div>
    </div>
    <div class="banner-dots" id="bannerDots"></div>
  </div>

  <div class="sec-head">üè™ Shop by Category</div>
  <div class="cats-scroll" id="catsScroll"></div>

  <div class="filter-bar">
    <div class="fc active" data-f="all" onclick="setFilter('all',this)">All</div>
    <div class="fc" data-f="featured" onclick="setFilter('featured',this)">‚≠ê Featured</div>
    <div class="fc" data-f="bulk" onclick="setFilter('bulk',this)">üí∞ Bulk Deals</div>
    <div class="fc" data-f="inStock" onclick="setFilter('inStock',this)">‚úÖ In Stock</div>
  </div>

  <div class="sec-head" id="productsTitle">üõçÔ∏è All Products</div>
  <div class="products-grid" id="productsGrid"></div>
</div>

<!-- OVERLAY + CART -->
<div class="overlay" id="overlay" onclick="closeCart()"></div>
<div class="cart-sidebar" id="cartSidebar">
  <div class="cart-hdr">
    <div class="cart-hdr-left">
      <h2>üõí My Cart</h2>
      <div class="cart-meta" id="cartMeta">0 items</div>
    </div>
    <button class="cart-close" onclick="closeCart()">‚úï</button>
  </div>

  <!-- Total savings hero ‚Äî only shown when saving something -->
  <div class="cart-savings-hero" id="savingsHero" style="display:none">
    <div class="savings-icon">üéâ</div>
    <div class="savings-text">
      <div class="savings-label">YOU'RE SAVING</div>
      <div class="savings-amt">‚Çπ<span id="heroSaving">0</span></div>
      <div class="savings-sub">via bulk pricing discounts</div>
    </div>
    <div class="savings-badge">
      <div class="sb-label">saved per</div>
      <div class="sb-val" id="heroPct">0%</div>
    </div>
  </div>

  <div class="delivery-strip">
    <span>üèòÔ∏è</span>
    <p>BSC Society only ‚Ä¢ <span class="free-tag">FREE</span> delivery ‚Ä¢ Min ‚Çπ<span id="minOrderLabel">99</span></p>
  </div>

  <!-- Min order progress -->
  <div class="min-order-bar" id="minOrderBar">
    <div class="mob-row">
      <span class="mob-label" id="mobLabel">Add more to unlock checkout</span>
      <span class="mob-amt" id="mobAmt">‚Çπ0 / ‚Çπ99</span>
    </div>
    <div class="mob-progress"><div class="mob-fill" id="mobFill" style="width:0%"></div></div>
  </div>

  <div class="cart-items" id="cartItems">
    <div class="cart-empty"><div class="ei">üõí</div><p>Your cart is empty<br><span style="font-size:.78rem">Add items to start saving!</span></p></div>
  </div>

  <div class="cart-footer" id="cartFooter" style="display:none">
    <div class="bill-section">
      <div class="bill-row"><span class="bl">Items (MRP)</span><span class="br" id="billMrp">‚Çπ0</span></div>
      <div class="bill-row savings-row" id="billSavingsRow" style="display:none"><span class="bl">üéâ Bulk Savings</span><span class="br" id="billSavings">-‚Çπ0</span></div>
      <div class="bill-row"><span class="bl">Delivery</span><span class="br" style="color:#34d399">FREE üéâ</span></div>
      <hr class="bill-divider">
      <div class="bill-total-row"><span class="tl">Total Payable</span><span class="tr" id="billTotal">‚Çπ0</span></div>
    </div>
    <button class="checkout-btn" id="checkoutBtn" onclick="openOrderModal()">
      <span>Proceed to Checkout</span>
      <span class="cbamt" id="btnTotal">‚Çπ0</span>
    </button>
    <div style="text-align:center;margin-top:.55rem;color:rgba(255,255,255,.3);font-size:.65rem" id="minOrderWarn"></div>
  </div>
</div>

<!-- FLOATING CART -->
<button class="floating-cart" id="floatingCart" onclick="openCart()">
  <div class="fc-left">
    <div class="fc-cnt" id="fcCnt">0</div>
    <div class="fc-info">
      <div class="fc-items" id="fcItems">items in cart</div>
      <div class="fc-saving" id="fcSaving" style="display:none">Saving ‚Çπ<span id="fcSavingAmt">0</span> üéâ</div>
    </div>
  </div>
  <div class="fc-right">View Cart ‚Üí</div>
</button>

<!-- ORDER MODAL -->
<div class="modal-overlay" id="orderModal">
  <div class="modal">
    <div class="modal-handle"></div>
    <div class="modal-head"><h2>üì¶ Complete Your Order</h2></div>
    <div id="modalBodyWrap">
      <div class="modal-body">
        <div class="fg"><label>Your Name</label><input type="text" id="custName" placeholder="Full name"></div>
        <div class="fg"><label>Phone Number</label><input type="tel" id="custPhone" placeholder="10-digit mobile" maxlength="10"></div>
        <div class="block-hint">üìç BSC Society only ‚Äî select your Block and Villa number</div>
        <div class="addr-row">
          <div class="fg">
            <label>Block</label>
            <select id="custBlock">
              <option value="">Select Block</option>
              <option value="A">Block A (80 Villas)</option>
              <option value="B">Block B (90 Villas)</option>
              <option value="C">Block C (130 Villas)</option>
              <option value="D">Block D (300 Villas)</option>
            </select>
          </div>
          <div class="fg"><label>Villa Number</label><input type="number" id="custVilla" placeholder="e.g. 42" min="1"></div>
        </div>
        <div class="qr-card">
          <h3>üí≥ Scan & Pay</h3>
          <div class="qr-sub">Pay via QR, then place your order</div>
          <div class="qr-img-box" id="qrBox"><span>üì∑<br>QR loading...</span></div>
          <div class="pay-amt" id="payAmount">‚Çπ0</div>
          <div class="pay-note">Tap "Place Order" after payment</div>
        </div>
        <div class="order-summary">
          <div class="os-row"><span>MRP Total</span><span id="co-mrp">‚Çπ0</span></div>
          <div class="os-row saving" id="co-saving-row" style="display:none"><span>üéâ Bulk Savings</span><span id="co-saving">-‚Çπ0</span></div>
          <div class="os-row" style="color:var(--green);font-weight:600"><span>Delivery</span><span>FREE üéâ</span></div>
          <div class="os-row total"><span>Total Payable</span><span id="co-total">‚Çπ0</span></div>
        </div>
        <button class="place-btn" onclick="placeOrder()">‚úÖ Place Order on WhatsApp</button>
      </div>
    </div>
    <div class="success-screen" id="successScreen">
      <span class="success-anim">üéâ</span>
      <h2>Order Placed!</h2>
      <p id="successMsg">Sent to BSC Store via WhatsApp. We'll deliver it soon! üöÄ</p>
      <button class="continue-btn" onclick="resetAll()">Continue Shopping</button>
    </div>
  </div>
</div>

<!-- ACCOUNT MODAL -->
<div class="acct-modal" id="acctModal">
  <div class="acct-box">
    <div class="acct-box-hd">
      <h3>üë§ My Account</h3>
      <button class="acct-close" onclick="closeAcct()">‚úï</button>
    </div>
    <div id="acctContent"></div>
  </div>
</div>

<script>
// ‚îÄ‚îÄ STATE ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
let allProducts=[], allCategories=[], storeSettings={};
let cart={}, activeCategory='all', searchQuery='', activeFilter='all';
let currentUser = JSON.parse(localStorage.getItem('bsc_user')||'null');
let customerToken = localStorage.getItem('bsc_token')||null;

const IMGS={1:'https://images.unsplash.com/photo-1586201375761-83865001e31c?w=300&q=80',2:'https://images.unsplash.com/photo-1574323347407-f5e1ad6d020b?w=300&q=80',3:'https://images.unsplash.com/photo-1612257419038-4bc7a2af2c3a?w=300&q=80',4:'https://images.unsplash.com/photo-1474979266404-7eaacbcd87c5?w=300&q=80',5:'https://images.unsplash.com/photo-1565299543923-37dd37887442?w=300&q=80',6:'https://images.unsplash.com/photo-1518110925495-5fe2fda0442c?w=300&q=80',7:'https://images.unsplash.com/photo-1561155707-8f5d27df1e31?w=300&q=80',8:'https://images.unsplash.com/photo-1508747703725-719777637510?w=300&q=80',9:'https://images.unsplash.com/photo-1518977676601-b53f82aba655?w=300&q=80',10:'https://images.unsplash.com/photo-1576045057995-568f588f82fb?w=300&q=80',11:'https://images.unsplash.com/photo-1563565375-f3fdfdbefa83?w=300&q=80',12:'https://images.unsplash.com/photo-1568584711075-3d021a7c3ca3?w=300&q=80',13:'https://images.unsplash.com/photo-1571771894821-ce9b6c11b08e?w=300&q=80',14:'https://images.unsplash.com/photo-1560806887-1e4cd0b6cbd6?w=300&q=80',15:'https://images.unsplash.com/photo-1582979512210-99b6a53386f9?w=300&q=80',16:'https://images.unsplash.com/photo-1537640538966-79f369143f8f?w=300&q=80',17:'https://images.unsplash.com/photo-1550583724-b2692b85b150?w=300&q=80',18:'https://images.unsplash.com/photo-1631452180519-c014fe946bc7?w=300&q=80',19:'https://images.unsplash.com/photo-1488477181946-6428a0291777?w=300&q=80',20:'https://images.unsplash.com/photo-1589985270826-4b7bb135bc9d?w=300&q=80',21:'https://images.unsplash.com/photo-1622483767028-3f66f32aef97?w=300&q=80',22:'https://images.unsplash.com/photo-1629203851122-3726ecdf080e?w=300&q=80',23:'https://images.unsplash.com/photo-1625772299848-391b6a87d7b3?w=300&q=80',24:'https://images.unsplash.com/photo-1548839140-29a749e1cf4d?w=300&q=80',25:'https://images.unsplash.com/photo-1601924582970-9238bcb495d9?w=300&q=80',26:'https://images.unsplash.com/photo-1566478989037-eec170784d0b?w=300&q=80',27:'https://images.unsplash.com/photo-1578849278619-e73505e9610f?w=300&q=80',28:'https://images.unsplash.com/photo-1558961363-fa8fdf82db35?w=300&q=80',29:'https://images.unsplash.com/photo-1569718212165-3a8278d5f624?w=300&q=80',30:'https://images.unsplash.com/photo-1583947581888-c3d7f2a5d3dc?w=300&q=80',31:'https://images.unsplash.com/photo-1585584114963-503344a119b0?w=300&q=80',32:'https://images.unsplash.com/photo-1563453392212-326f5e854473?w=300&q=80'};
const CAT_IMGS={grocery:'https://images.unsplash.com/photo-1542838132-92c53300491e?w=100&q=80',vegetables:'https://images.unsplash.com/photo-1597362925123-77861d3fbac7?w=100&q=80',fruits:'https://images.unsplash.com/photo-1619566636858-adf3ef46400b?w=100&q=80',dairy:'https://images.unsplash.com/photo-1550583724-b2692b85b150?w=100&q=80',drinks:'https://images.unsplash.com/photo-1527960471264-932f39eb5846?w=100&q=80',snacks:'https://images.unsplash.com/photo-1566478989037-eec170784d0b?w=100&q=80',cleaning:'https://images.unsplash.com/photo-1563453392212-326f5e854473?w=100&q=80'};

// ‚îÄ‚îÄ PER-PRODUCT BULK PRICING ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
// bulkTiers: [{minQty:1,pricePerUnit:10},{minQty:5,pricePerUnit:9},{minQty:10,pricePerUnit:8}]
// Returns the price per unit for a given qty based on the product's tiers
function getUnitPrice(product, qty) {
  const tiers = (product.bulkTiers || []).slice().sort((a,b) => a.minQty - b.minQty);
  if (!tiers.length) return product.price;
  let price = tiers[0].pricePerUnit;
  for (const t of tiers) {
    if (qty >= t.minQty) price = t.pricePerUnit;
  }
  return price;
}

// MRP price (tier with minQty=1, or product.price)
function getMrpPrice(product) {
  const tiers = (product.bulkTiers || []).filter(t => t.minQty <= 1);
  return tiers.length ? tiers[0].pricePerUnit : product.price;
}

// Returns next tier above current qty (to show "add X more to save ‚ÇπY/unit")
function getNextTier(product, qty) {
  const tiers = (product.bulkTiers || []).slice().sort((a,b) => a.minQty - b.minQty);
  return tiers.find(t => t.minQty > qty) || null;
}

// Current tier for qty
function getCurrentTier(product, qty) {
  const tiers = (product.bulkTiers || []).slice().sort((a,b) => a.minQty - b.minQty);
  let cur = null;
  for (const t of tiers) { if (qty >= t.minQty) cur = t; }
  return cur;
}

function hasBulkTiers(product) {
  return (product.bulkTiers || []).length > 1;
}

// ‚îÄ‚îÄ LOAD DATA ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
async function loadData() {
  const res = await fetch('/api/products');
  const data = await res.json();
  allProducts = data.products; allCategories = data.categories; storeSettings = data.settings;
  renderCategories(); renderProducts();
  if (storeSettings.qrUrl) document.getElementById('qrBox').innerHTML = `<img src="${storeSettings.qrUrl}">`;
  const mo = storeSettings.minOrder || 99;
  document.getElementById('minOrderLabel').textContent = mo;
  document.getElementById('mobAmt').textContent = `‚Çπ0 / ‚Çπ${mo}`;
}

// ‚îÄ‚îÄ BANNER ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
let bIdx=0;
(function setupBanner(){
  const dots=document.getElementById('bannerDots');
  dots.innerHTML=[0,1,2,3].map(i=>`<div class="dot ${i===0?'active':''}" onclick="goBanner(${i})"></div>`).join('');
  setInterval(()=>goBanner((bIdx+1)%4),4500);
})();
function goBanner(i){bIdx=i;document.getElementById('bannerSlider').style.transform=`translateX(-${i*100}%)`;document.querySelectorAll('.dot').forEach((d,j)=>d.classList.toggle('active',j===i));}

// ‚îÄ‚îÄ CATEGORIES ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function renderCategories(){
  document.getElementById('catsScroll').innerHTML=[{id:'all',name:'All Items',emoji:'üõçÔ∏è'},...allCategories].map(c=>`
    <div class="cat-chip ${c.id===activeCategory?'active':''}" onclick="setCategory('${c.id}')">
      ${CAT_IMGS[c.id]?`<img src="${CAT_IMGS[c.id]}" onerror="this.outerHTML='<span style=font-size:1.8rem>${c.emoji||'üõçÔ∏è'}</span>'">`:`<span style="font-size:1.8rem">${c.emoji||'üõçÔ∏è'}</span>`}
      <span class="name">${c.name}</span>
    </div>`).join('');
}
function setCategory(id){activeCategory=id;searchQuery='';activeFilter='all';document.getElementById('searchInput').value='';document.querySelectorAll('.fc').forEach(c=>c.classList.toggle('active',c.dataset.f==='all'));renderCategories();document.getElementById('productsTitle').textContent=id==='all'?'üõçÔ∏è All Products':allCategories.find(c=>c.id===id)?.name||id;renderProducts();}
function setFilter(f,el){activeFilter=f;document.querySelectorAll('.fc').forEach(c=>c.classList.remove('active'));el.classList.add('active');renderProducts();}
function doSearch(q){searchQuery=q.toLowerCase();activeCategory='all';renderCategories();renderProducts();}

// ‚îÄ‚îÄ PRODUCTS ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function getImg(p){ return (p.imageUrl&&p.imageUrl.trim()) ? p.imageUrl.trim() : IMGS[p.id]||null; }

function renderProducts(){
  let list = allProducts.filter(p => {
    const mc = activeCategory==='all'||p.cat===activeCategory;
    const ms = !searchQuery||p.name.toLowerCase().includes(searchQuery);
    let mf = true;
    if(activeFilter==='featured') mf=p.featured;
    if(activeFilter==='bulk') mf=hasBulkTiers(p);
    if(activeFilter==='inStock') mf=p.inStock&&p.stock>0;
    return mc&&ms&&mf;
  });
  const grid=document.getElementById('productsGrid');
  if(!list.length){grid.innerHTML=`<div style="grid-column:1/-1;text-align:center;padding:3rem;color:var(--subtext)"><div style="font-size:3rem">üîç</div><p>No products found</p></div>`;return;}

  grid.innerHTML=list.map(p=>{
    const qty=cart[p.id]||0;
    const img=getImg(p);
    const unitPrice=getUnitPrice(p,qty);
    const mrp=getMrpPrice(p);
    const hasBulk=hasBulkTiers(p);
    const isBulkActive=hasBulk&&unitPrice<mrp;
    const tiers=(p.bulkTiers||[]).slice().sort((a,b)=>a.minQty-b.minQty);
    const lowStock=p.stock>0&&p.stock<=5;
    const nextTier=getNextTier(p,qty);

    // Bulk tiers preview chips (show on card always if has tiers)
    const tiersPreview=hasBulk?`<div class="bulk-tiers-preview">${tiers.map(t=>`<div class="btp ${qty>=t.minQty?'active':''}">x${t.minQty}: ‚Çπ${t.pricePerUnit}</div>`).join('')}</div>`:'';

    // Bulk hint (show cheapest tier)
    const cheapest=tiers.length?tiers[tiers.length-1]:null;
    const bulkHint=hasBulk&&cheapest?`<div class="bulk-hint">üí∞ Buy ${cheapest.minQty}+ @ ‚Çπ${cheapest.pricePerUnit}</div>`:'';

    return `<div class="product-card ${p.featured?'featured':''}">
      ${p.featured?'<div class="badge-feat">‚≠ê Featured</div>':''}
      ${hasBulk?`<div class="badge-bulk">üí∞ Bulk Deal</div>`:''}
      <div class="product-img-wrap">
        ${img?`<img src="${img}" alt="${p.name}" loading="lazy" onerror="this.outerHTML='<span class=fallback-e>${p.emoji}</span>'">`:`<span class="fallback-e">${p.emoji}</span>`}
        ${(!p.inStock||p.stock===0)?'<div class="out-overlay">Out of Stock</div>':''}
        ${lowStock?`<div class="stock-low">Only ${p.stock} left</div>`:''}
      </div>
      <div class="product-body">
        <div class="product-name" title="${p.name}">${p.name}</div>
        <div class="product-unit">${p.unit}</div>
        ${tiersPreview}
        ${bulkHint}
        <div class="price-row">
          <div class="price-block">
            <div class="price-main ${isBulkActive?'bulk':''}">‚Çπ${unitPrice}</div>
            ${isBulkActive?`<div class="price-orig">‚Çπ${mrp}</div>`:''}
          </div>
          ${qty===0
            ?`<button class="add-btn" onclick="addToCart(${p.id})" ${(!p.inStock||p.stock===0)?'disabled':''}>ADD</button>`
            :`<div class="qty-box"><button onclick="changeQty(${p.id},-1)">‚àí</button><span class="qnum">${qty}</span><button onclick="changeQty(${p.id},1)">+</button></div>`}
        </div>
        ${nextTier&&qty>0?`<div style="font-size:.6rem;color:#f59e0b;margin-top:.3rem">‚ûï Add ${nextTier.minQty-qty} more ‚Üí ‚Çπ${nextTier.pricePerUnit}/unit</div>`:''}
      </div>
    </div>`;
  }).join('');
}

// ‚îÄ‚îÄ CART LOGIC ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function addToCart(id){cart[id]=(cart[id]||0)+1;updateCart();renderProducts();}
function changeQty(id,d){cart[id]=(cart[id]||0)+d;if(cart[id]<=0)delete cart[id];updateCart();renderProducts();}

// Per-product: total item cost at current qty (bulk price √ó qty)
function itemTotal(p, qty){ return getUnitPrice(p,qty)*qty; }
// Per-product: what it would cost at MRP √ó qty
function itemMrp(p, qty){ return getMrpPrice(p)*qty; }

function getCartTotals(){
  let mrpTotal=0, actualTotal=0;
  Object.entries(cart).forEach(([id,qty])=>{
    const p=allProducts.find(x=>x.id==id); if(!p)return;
    mrpTotal+=itemMrp(p,qty);
    actualTotal+=itemTotal(p,qty);
  });
  return {mrpTotal,actualTotal,savings:mrpTotal-actualTotal};
}

function getCount(){ return Object.values(cart).reduce((a,b)=>a+b,0); }

function updateCart(){
  const n=getCount();
  const {mrpTotal,actualTotal,savings}=getCartTotals();
  const minOrder=storeSettings.minOrder||99;

  // Header
  document.getElementById('cartCount').textContent=n;
  document.getElementById('fcCnt').textContent=n;
  document.getElementById('cartMeta').textContent=`${n} item${n!==1?'s':''}`;

  // Floating cart savings
  document.getElementById('fcItems').textContent=`${n} item${n!==1?'s':''} ‚Ä¢ ‚Çπ${actualTotal}`;
  if(savings>0){document.getElementById('fcSaving').style.display='block';document.getElementById('fcSavingAmt').textContent=savings;}
  else{document.getElementById('fcSaving').style.display='none';}

  // Savings hero in cart
  const hero=document.getElementById('savingsHero');
  if(savings>0&&n>0){
    hero.style.display='flex';
    document.getElementById('heroSaving').textContent=savings;
    document.getElementById('heroPct').textContent=Math.round(savings/mrpTotal*100)+'%';
  } else { hero.style.display='none'; }

  // Bill
  document.getElementById('billMrp').textContent='‚Çπ'+mrpTotal;
  document.getElementById('billTotal').textContent='‚Çπ'+actualTotal;
  document.getElementById('btnTotal').textContent='‚Çπ'+actualTotal;
  if(savings>0){document.getElementById('billSavingsRow').style.display='flex';document.getElementById('billSavings').textContent='-‚Çπ'+savings;}
  else{document.getElementById('billSavingsRow').style.display='none';}

  // Min order progress
  const prog=Math.min(100,actualTotal/minOrder*100);
  document.getElementById('mobFill').style.width=prog+'%';
  document.getElementById('mobAmt').textContent=`‚Çπ${actualTotal} / ‚Çπ${minOrder}`;
  const checkoutBtn=document.getElementById('checkoutBtn');
  const warn=document.getElementById('minOrderWarn');
  if(n>0&&actualTotal<minOrder){
    document.getElementById('mobLabel').textContent=`‚Çπ${minOrder-actualTotal} more to unlock checkout`;
    checkoutBtn.disabled=true; warn.textContent=`‚ö†Ô∏è Minimum order is ‚Çπ${minOrder}`;
  } else {
    document.getElementById('mobLabel').textContent='üéâ You\'re good to go!';
    checkoutBtn.disabled=false; warn.textContent='';
  }

  document.getElementById('cartFooter').style.display=n>0?'block':'none';
  const fc=document.getElementById('floatingCart');
  fc.classList.toggle('show',n>0&&!document.getElementById('cartSidebar').classList.contains('open'));
  renderCartItems();
}

function renderCartItems(){
  const el=document.getElementById('cartItems');
  const items=Object.entries(cart);
  if(!items.length){el.innerHTML='<div class="cart-empty"><div class="ei">üõí</div><p>Your cart is empty<br><span style="font-size:.78rem">Add items to start saving!</span></p></div>';return;}

  el.innerHTML=items.map(([id,qty])=>{
    const p=allProducts.find(x=>x.id==id);if(!p)return'';
    const img=getImg(p);
    const unitPrice=getUnitPrice(p,qty);
    const mrp=getMrpPrice(p);
    const totalCost=unitPrice*qty;
    const totalMrp=mrp*qty;
    const saving=totalMrp-totalCost;
    const isBulk=unitPrice<mrp;
    const curTier=getCurrentTier(p,qty);
    const nextTier=getNextTier(p,qty);
    const tiers=(p.bulkTiers||[]).slice().sort((a,b)=>a.minQty-b.minQty);
    const hasTiers=tiers.length>0;

    // Tier ladder ‚Äî visual pips showing all tiers
    let tierLadder='';
    if(hasTiers&&tiers.length>1){
      const pips=tiers.map((t,i)=>{
        const isActive=qty>=t.minQty;
        const isNext=nextTier&&nextTier.minQty===t.minQty;
        const dc=isActive?'active':isNext?'next':'';
        const lc=isActive?'active':isNext?'next':'';
        const arr=i<tiers.length-1?'<div class="ci-tier-arrow">‚Ä∫</div>':'';
        return '<div class="ci-tier-pip"><div class="ci-tier-dot '+dc+'">'+t.minQty+'</div><div class="ci-tier-label '+lc+'">‚Çπ'+t.pricePerUnit+'</div></div>'+arr;
      }).join('');
      tierLadder='<div class="ci-tier-ladder">'+pips+'</div>';
    }

    // Unlock bar for next tier
    let unlockBar='';
    if(nextTier){
      const prevQty=curTier?curTier.minQty:0;
      const progress=Math.round(Math.max(0,(qty-prevQty)/(nextTier.minQty-prevQty)*100));
      const need=nextTier.minQty-qty;
      unlockBar='<div class="ci-unlock-bar"><div class="ci-unlock-row"><span class="ci-unlock-label">‚ûï Add '+need+' more ‚Üí ‚Çπ'+nextTier.pricePerUnit+'/unit</span></div><div class="ci-unlock-progress"><div class="ci-unlock-fill" style="width:'+progress+'%"></div></div></div>';
    }

    const imgEl=img?'<img class="ci-img" src="'+img+'" onerror="this.style.display=\'none\'">':'<div class="ci-emoji">'+p.emoji+'</div>';
    const savingEl=saving>0?'<div class="ci-saving-big"><span>-‚Çπ'+saving+'</span><span class="sl">saved vs MRP ‚Çπ'+totalMrp+'</span></div>':'';
    const totalEl=saving>0?'':'<div class="ci-subtotal">‚Çπ'+totalCost+'</div>';
    const bulkTag=isBulk&&curTier?'<span class="ci-bulk-tag">üì¶ Bulk price</span>':'';

    return '<div class="cart-item">'
      +imgEl
      +'<div class="ci-body">'
        +'<div class="ci-name">'+p.name+'</div>'
        +'<div class="ci-price-line"><span class="ci-unit-price">‚Çπ'+unitPrice+'/unit √ó '+qty+'</span>'+bulkTag+'</div>'
        +savingEl+totalEl
        +tierLadder
        +unlockBar
      +'</div>'
      +'<div style="display:flex;flex-direction:column;align-items:center;gap:.3rem;flex-shrink:0">'
        +'<div class="ci-controls">'
          +'<button onclick="changeQty('+p.id+',-1)">‚àí</button>'
          +'<span class="cnum">'+qty+'</span>'
          +'<button onclick="changeQty('+p.id+',1)">+</button>'
        +'</div>'
        +'<div style="color:'+(saving>0?'#34d399':'rgba(255,255,255,.5)')+';font-weight:800;font-size:.82rem">‚Çπ'+totalCost+'</div>'
      +'</div>'
    +'</div>';
  }).join('');
}

function openCart(){document.getElementById('cartSidebar').classList.add('open');document.getElementById('overlay').classList.add('open');document.getElementById('floatingCart').classList.remove('show');}
function closeCart(){document.getElementById('cartSidebar').classList.remove('open');document.getElementById('overlay').classList.remove('open');if(getCount()>0)document.getElementById('floatingCart').classList.add('show');}

// ‚îÄ‚îÄ ORDER MODAL ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function openOrderModal(){
  const {mrpTotal,actualTotal,savings}=getCartTotals();
  document.getElementById('payAmount').textContent='‚Çπ'+actualTotal;
  document.getElementById('co-mrp').textContent='‚Çπ'+mrpTotal;
  document.getElementById('co-total').textContent='‚Çπ'+actualTotal;
  const savingRow=document.getElementById('co-saving-row');
  if(savings>0){savingRow.style.display='flex';document.getElementById('co-saving').textContent='-‚Çπ'+savings;}
  else{savingRow.style.display='none';}
  if(currentUser){document.getElementById('custName').value=currentUser.name||'';document.getElementById('custPhone').value=currentUser.phone||'';}
  closeCart();
  document.getElementById('orderModal').classList.add('open');
  document.getElementById('modalBodyWrap').style.display='block';
  document.getElementById('successScreen').classList.remove('show');
}
document.getElementById('orderModal').addEventListener('click',function(e){if(e.target===this)this.classList.remove('open');});

async function placeOrder(){
  const name=document.getElementById('custName').value.trim();
  const phone=document.getElementById('custPhone').value.trim();
  const block=document.getElementById('custBlock').value;
  const villa=document.getElementById('custVilla').value.trim();
  if(!name){alert('Please enter your name');return;}
  if(!phone||phone.length!==10){alert('Please enter a valid 10-digit phone');return;}
  if(!block){alert('Please select your block');return;}
  if(!villa){alert('Please enter your villa number');return;}
  const maxVillas={A:80,B:90,C:130,D:300};
  if(parseInt(villa)<1||parseInt(villa)>maxVillas[block]){alert(`Block ${block} has villas 1‚Äì${maxVillas[block]}`);return;}

  const {mrpTotal,actualTotal,savings}=getCartTotals();
  const items=Object.entries(cart).map(([id,qty])=>{
    const p=allProducts.find(x=>x.id==id);
    return{id:p.id,name:p.name,emoji:p.emoji,qty,unitPrice:getUnitPrice(p,qty),total:getUnitPrice(p,qty)*qty,mrpUnitPrice:getMrpPrice(p),saving:(getMrpPrice(p)-getUnitPrice(p,qty))*qty};
  });

  try{
    const r=await fetch('/api/orders',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({name,phone,block,villa,items,total:mrpTotal,discountAmt:savings,finalTotal:actualTotal,customerId:currentUser?.id||null})});
    if(!r.ok){const e=await r.json();alert(e.error||'Error');return;}
  }catch(e){console.error(e);}

  const savingLine=savings>0?`\nüéâ *Bulk Savings: -‚Çπ${savings}*`:'';
  const lines=items.map(i=>`‚Ä¢ ${i.emoji} ${i.name} √ó${i.qty} @ ‚Çπ${i.unitPrice} = ‚Çπ${i.total}${i.saving>0?` (saved ‚Çπ${i.saving})`:''}`).join('\n');
  const msg=`üõí *New Order ‚Äî BSC Store*\n\nüë§ *Name:* ${name}\nüìû *Phone:* ${phone}\nüìç *Address:* Block ${block}, Villa No. ${villa}\n\nüì¶ *Items:*\n${lines}\n\nüíµ MRP Total: ‚Çπ${mrpTotal}${savingLine}\nüöö Delivery: FREE\nüí∞ *Total Paid: ‚Çπ${actualTotal}*\n\n‚úÖ Paid via QR`;
  window.open(`https://wa.me/${storeSettings.whatsapp||'919999999999'}?text=${encodeURIComponent(msg)}`,'_blank');
  document.getElementById('modalBodyWrap').style.display='none';
  document.getElementById('successScreen').classList.add('show');
  document.getElementById('successMsg').textContent=`Order placed! Block ${block}, Villa ${villa}. On the way soon üöÄ${savings>0?' You saved ‚Çπ'+savings+'! üéâ':''}`;
}

function resetAll(){cart={};updateCart();renderProducts();document.getElementById('orderModal').classList.remove('open');['custName','custPhone','custVilla'].forEach(id=>document.getElementById(id).value='');document.getElementById('custBlock').value='';}

// ‚îÄ‚îÄ ACCOUNT ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function openAcct(){renderAcct();document.getElementById('acctModal').classList.add('open');}
function closeAcct(){document.getElementById('acctModal').classList.remove('open');}
document.getElementById('acctModal').addEventListener('click',function(e){if(e.target===this)this.classList.remove('open');});

function renderAcct(){
  const el=document.getElementById('acctContent');
  if(currentUser){
    el.innerHTML=`<div class="acct-body"><div class="logged-view"><div class="user-avatar">üë§</div><h3>${currentUser.name}</h3><p>üìû ${currentUser.phone}</p><div class="oh-list" id="ohList"><h4>üì¶ My Orders</h4><p style="color:var(--subtext);font-size:.78rem">Loading...</p></div><button class="logout-btn" onclick="logout()">üö™ Logout</button></div></div>`;
    loadMyOrders();
  } else {
    el.innerHTML=`<div><div class="acct-tabs"><button class="atab active" id="loginTab" onclick="switchTab('login')">Login</button><button class="atab" id="regTab" onclick="switchTab('reg')">Register</button></div><div class="acct-body" id="authBody">${loginForm()}</div></div>`;
  }
}
function loginForm(){return`<div class="auth-form"><div class="fg"><label>Phone</label><input type="tel" id="ap" placeholder="10-digit number" maxlength="10"></div><div class="fg"><label>Password</label><input type="password" id="aw" placeholder="Your password"></div><button class="auth-submit" onclick="doLogin()">Login</button><div class="auth-msg" id="amsg"></div></div>`;}
function regForm(){return`<div class="auth-form"><div class="fg"><label>Full Name</label><input type="text" id="an" placeholder="Your name"></div><div class="fg"><label>Phone</label><input type="tel" id="ap" placeholder="10-digit number" maxlength="10"></div><div class="fg"><label>Password</label><input type="password" id="aw" placeholder="Create a password"></div><button class="auth-submit" onclick="doRegister()">Create Account</button><div class="auth-msg" id="amsg"></div></div>`;}
function switchTab(t){document.getElementById('loginTab').classList.toggle('active',t==='login');document.getElementById('regTab').classList.toggle('active',t==='reg');document.getElementById('authBody').innerHTML=t==='login'?loginForm():regForm();}
async function doLogin(){const ph=document.getElementById('ap').value.trim(),pw=document.getElementById('aw').value,m=document.getElementById('amsg');if(!ph||!pw){m.textContent='Fill all fields';m.className='auth-msg err';return;}const r=await fetch('/api/customer/login',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({phone:ph,password:pw})});const d=await r.json();if(r.ok){currentUser=d.customer;customerToken=d.token;localStorage.setItem('bsc_user',JSON.stringify(currentUser));localStorage.setItem('bsc_token',customerToken);renderAcct();}else{m.textContent=d.error||'Failed';m.className='auth-msg err';}}
async function doRegister(){const nm=document.getElementById('an').value.trim(),ph=document.getElementById('ap').value.trim(),pw=document.getElementById('aw').value,m=document.getElementById('amsg');if(!nm||!ph||!pw){m.textContent='Fill all fields';m.className='auth-msg err';return;}const r=await fetch('/api/customer/register',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({name:nm,phone:ph,password:pw})});const d=await r.json();if(r.ok){currentUser=d.customer;customerToken=d.token;localStorage.setItem('bsc_user',JSON.stringify(currentUser));localStorage.setItem('bsc_token',customerToken);renderAcct();}else{m.textContent=d.error||'Failed';m.className='auth-msg err';}}
async function loadMyOrders(){if(!customerToken)return;const r=await fetch('/api/customer/orders',{headers:{'Authorization':'Bearer '+customerToken}});if(!r.ok)return;const orders=await r.json();const el=document.getElementById('ohList');if(!el)return;if(!orders.length){el.innerHTML='<h4>üì¶ My Orders</h4><p style="color:var(--subtext);font-size:.78rem">No orders yet</p>';return;}el.innerHTML=`<h4>üì¶ My Orders</h4>`+orders.slice(0,5).map(o=>`<div class="oh-item"><div><div style="font-weight:600;font-size:.8rem">${o.address}</div><div class="oh-date">${new Date(o.createdAt).toLocaleDateString('en-IN',{day:'numeric',month:'short'})}</div></div><div style="display:flex;align-items:center;gap:.4rem"><strong style="font-size:.82rem">‚Çπ${o.finalTotal||o.total}</strong><span class="oh-status ${o.status}">${o.status}</span></div></div>`).join('');}
function logout(){currentUser=null;customerToken=null;localStorage.removeItem('bsc_user');localStorage.removeItem('bsc_token');renderAcct();}

loadData();
</script>
</body>
</html>
